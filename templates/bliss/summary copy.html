{% extends 'bliss/base.html' %}
{% load humanize %}
{% load custom_filters %}
{% block title %}Resumo de Situações{% endblock %}

{% block content %}
<h3 class="mb-4">Resumo por Situação</h3>

<table class="table table-bordered table-sm">
    <thead class="table-light">
        <tr>
            <th>Situação</th>
            <th class="text-end">Total Valor Tabela</th>
            <th class="text-end">% Valor Tabela</th>
            <th class="text-end">Total Unidades</th>
            <th class="text-end">% Unidades</th>
        </tr>
    </thead>
    <tbody>
        {% for item in resumo %}
        <tr>
            <td>{{ item.situacao }}</td>
            <td class="text-end">{{ item.total_valor_tabela|format_real }}</td>
            <td class="text-end">{{ item.pct_valor_tabela|floatformat:2 }}%</td>
            <td class="text-end">{{ item.total_unidades }}</td>
            <td class="text-end">{{ item.pct_unidades|floatformat:2 }}%</td>
        </tr>
        {% endfor %}
        <tr class="fw-bold table-light">
            <td>Total Geral</td>
            <td class="text-end">{{ totais.valor_tabela|format_real }}</td>
            <td class="text-end">100%</td>
            <td class="text-end">{{ totais.unidades }}</td>
            <td class="text-end">100%</td>
        </tr>
    </tbody>
</table>

<hr class="my-5">

<h3 class="mt-5">Resumo por Tipo</h3>
<table class="table table-bordered w-100">
    <thead class="table-light text-center">
        <tr>
            <th>Preço Médio Tipo</th>
            <th>Qtde</th>
            <th>Tipo</th>
            <th>M² Priv</th>
            <th>Valor Tabela</th>
            <th>R$ do M²</th>
        </tr>
    </thead>
    <tbody class="text-end">
        {% for item in resumo_lojas %}
        <tr>
            <td class="text-center">
                {% if item.preco_medio_tipo %}
                    R$ {{ item.preco_medio_tipo|floatformat:2|intcomma }}
                {% endif %}
            </td>
            <td>{{ item.quantidade }}</td>
            <td class="text-start">{{ item.tipo }}</td>
            <td>{{ item.m2|floatformat:2|intcomma }}</td>
            <td>R$ {{ item.valor_venda|floatformat:2|intcomma }}</td>
            <td>R$ {{ item.valor_m2|floatformat:2|intcomma }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>


{% endblock %}
